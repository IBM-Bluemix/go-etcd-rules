language: go
go:
  - 1.8.4
  - 1.9.1
  - 1.9.2
  - tip

matrix:
  fast_finish: true
  allow_failures:
  - go: tip

sudo: true

before_install:
  - sudo add-apt-repository ppa:masterminds/glide -y && sudo apt-get update -q
  - sudo apt-get install glide -y
  - curl -L  https://github.com/coreos/etcd/releases/download/v3.2.9/etcd-v3.2.9-linux-amd64.tar.gz -o etcd-v3.2.9-linux-amd64.tar.gz
  - tar xzvf etcd-v3.2.9-linux-amd64.tar.gz
  - ./etcd-v3.2.9-linux-amd64/etcd &

before_script:
  - make deps

script:
  - make test
  - make vet
  - make fmt

after_success:
    - 'if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then goveralls -coverprofile=coverage.out -service=travis-ci -repotoken $COVERALLS_TOKEN; fi'
